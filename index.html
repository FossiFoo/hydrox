

<!DOCTYPE html>
<html >
  <head>
    <meta charset="UTF-8">
    <meta name="google" value="notranslate">
    <link rel="icon" type="image/png" href="img/favicon.png" />

    <title>hydrox</title>

    
  <link href='http://fonts.googleapis.com/css?family=Raleway:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/css/bootstrap.min.css">
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/languages/clojure.min.js"></script>
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/magula.min.css">

  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.2/angular.min.js"></script>
  <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.2/angular-cookies.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.13.0/ui-bootstrap-tpls.min.js"></script>
  <script type="text/javascript" src="js/angular-highlightjs.min.js"></script>

  <link rel="stylesheet" type="text/css" href="css/rdash.min.css">
  <link rel="stylesheet" type="text/css" href="css/scrollspy.css">


  <script>
    window.console = window.console || function(t) {};
    window.open = function(){ console.log("window.open is disabled."); };
    window.print   = function(){ console.log("window.print is disabled."); };
  </script>

  <script>
    var app = angular.module('app', ['hljs']);
  </script>
  </head>

  <body ng-app="app" data-spy="scroll" data-target=".scrollspy">
  <!-- Fixed navbar -->
    <nav class="navbar navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html"><img src="img/logo-white.png"></a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li>
              <a href="https://github.com/helpshift/hydrox" target="_blank">Github</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


  <div class="container row">
    <div class="col-md-4 scrollspy pull-right">
      <ul id="nav" class="nav hidden-xs hidden-sm" data-spy="affix">
        <li><a href="#introduction">1  &nbsp;&nbsp; Introduction</a><ul class="nav"><li><a href="#installation">1.1  &nbsp;&nbsp; Installation</a></li><li><a href="#motivation">1.2  &nbsp;&nbsp; Motivation</a></li></ul></li><li><a href="#programming-vs-documentation">2  &nbsp;&nbsp; Programming vs Documentation</a></li><li><a href="#tooling-for-documents">3  &nbsp;&nbsp; Tooling for Documents</a><ul class="nav"><li><a href="#documentation-bugs">3.1  &nbsp;&nbsp; Documentation Bugs</a></li><li><a href="#test-cases-vs-docstrings">3.2  &nbsp;&nbsp; Test Cases vs Docstrings</a></li><li><a href="#bridging-the-divide">3.3  &nbsp;&nbsp; Bridging the Divide</a></li></ul></li><li><a href="#end-notes">4  &nbsp;&nbsp; End Notes</a></li>
      </ul>
    </div>
    <div class="col-md-8" id="content">
      <div class="jumbotron">
        <div class="container">
          <h1>hydrox</h1>
          <h4>dive deeper into your code</h4>
        </div>
      </div>
      <section class="chapter" id="introduction"><h2 class="chapter">1  &nbsp;&nbsp; Introduction</h2><div class="group"><div class="paragraph"><p><a href='https://www.github.com/helpshift/hydrox'>hydrox</a> is an in-repl tool which helps to enhance productivity around the entire program implementation process (design, development, testing and documentation). There are two main aspects of the tool that allow for this type of integrated workflow:</p><ul><li>management of function docstrings and metadata through tests</li><li>generation of html documentation from tests</li></ul></div></div><section class="section" id="installation"><h3 class="section">1.1  &nbsp;&nbsp; Installation</h3><div class="paragraph"><p>In your project.clj, add hydrox to the [:profiles :dev :dependencies] entry:</p><pre><code class="clojure">&#40;defproject ...
    ...
    :profiles {:dev {:dependencies &#91;...
                                    &#91;helpshift/hydrox &quot;0.1.0&quot;&#93;
                                    ...&#93;}}
    ...&#41;
</code></pre></div><div class="paragraph"><p>All functionality is the <code>hydrox.core</code> namespace:</p></div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(use 'hydrox.core)

(dive)    ;; initialises the tool, and watches project for files changes

(import-docstring) ;; imports docstrings into functions from test files

(purge-docstring)  ;; purges docstrings from functions

(generate-docs)    ;; generates html (like this one) from test files

(surface) ;; stops the tool
  </div><div class="paragraph"><p>A better experience can be obtained by using <a href='https://github.com/zcaudate/vinyasa'>vinyasa</a> and editing your <code>&#126;/.lein/profiles.clj</code> to inject all hydrox vars into the <code>.</code> namespace:</p><pre><code class="clojure">{:user 
   {:plugins &#91;...&#93;        
    :dependencies &#91;&#91;im.chit/vinyasa.inject &quot;0.3.4&quot;&#93;
                   &#91;helpshift/hydrox &quot;0.1.0&quot;&#93;&#93;
    :injections 
    &#91;&#40;require '&#91;vinyasa.inject :as inject&#93;&#41;
     &#40;inject/in &#91;hydrox.core dive surface single-use generate-docs import-docstring purge-docstring&#93;&#41;&#93;}}
</code></pre></div><div class="paragraph"><p>Functions can then be used like this within the repl:</p></div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(./dive)    ;; initialises the tool, and watches project for files changes

(./import-docstring) ;; imports docstrings into functions from test files

(./purge-docstring)  ;; purges docstrings from functions

(./generate-docs)    ;; generates html (like this one) from test files

(./surface) ;; stops the tool
  </div></section><section class="section" id="motivation"><h3 class="section">1.2  &nbsp;&nbsp; Motivation</h3><div class="paragraph"></div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(defproject ...
  ...
  :profiles {:dev {:dependencies [[midje &quot;1.5.1&quot;]]}}
  ...
  :documentation
  {:files {&quot;&lt;document-name&gt;&quot;             ;; my-first-document
           {:input &quot;&lt;input-file-path&gt;&quot;   ;; test/docs/my_first_document.clj
            :title &quot;&lt;title&gt;&quot;             ;; My First Document
            :sub-title &quot;&lt;sub title&gt;&quot;     ;; Learning how to use midje-doc
            :author &quot;&lt;name&gt;&quot;
            :email  &quot;&lt;email&gt;&quot;}}}
  ...)</div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(ns docs.my-first-document
  (:require [midje.sweet :refer :all]))

[[:chapter {:tag &quot;hello&quot; :title &quot;Hello Midje Doc&quot;}]]

&quot;This is an introduction to writing with midje-doc.&quot;

[[:section {:title &quot;Defining a function&quot;}]]

&quot;We define function `add-5`&quot;

[[{:numbered false}]]
(defn add-5 [x]
  (+ x 5))

[[:section {:title &quot;Testing a function&quot;}]]

&quot;`add-5` outputs the following results seen in
 [e.{{add-5-1}}](#add-5-1) and [e.{{add-5-10}}](#add-5-10):&quot;

(facts
  [[{:tag &quot;add-5-1&quot; :title &quot;1 add 5 = 6&quot;}]]
  (add-5 1) =&gt; 6

  [[{:tag &quot;add-5-10&quot; :title &quot;10 add 5 = 15&quot;}]]
  (add-5 10) =&gt; 15)</div></section></section><section class="chapter" id="programming-vs-documentation"><h2 class="chapter">2  &nbsp;&nbsp; Programming vs Documentation</h2><div class="group"><div class="paragraph"><p>The phrase 'Literate Programming' has been very popular lately. The main idea is that the code is written in a way that allows both a machine <em>and</em> a person to understand what is going on. Most people seem to agree that it is a great idea.</p><p>However Humans and machines are fundamentally different and rely on completely different methods of communication:</p><ul><li>Communication to Machines are usually very linear and procedural. It involves giving them a specific set of instructions. First Do This, Then Do That.... Machines don't really care what the code does. It just executes whatever code it has been given.</li></ul><ul><li>Communication to Humans usually take a very different form. We wish to be engaged, inspired and taught, not given a sequence of instructions that each break down to even smaller sequences. The best documentation are usally seperated into logical sections like an <code>overview</code>, <code>table of contents</code>, <code>list of figures</code>, <code>topic chapters</code>, <code>subsections</code>. There are <code>text</code>, <code>code</code>, <code>pictures</code>, even <code>sound</code> and <code>video</code>. Documentation structure resemble trees, with links between content that connect related topics and content. They do not resemble program code and therefore should be created independently of the machine code itself.</li></ul><p><strong>In short:</strong> Machines are programmed while humans are engaged, inspired and taught. <em>Programs</em> are written linearly for machines. <em>Documentation</em> are written like a woven lattice for humans. The fundamental structure of programs and documentation are very different from each other. Therefore, thinking that documentation can be automatically generated from doc-strings is a <strong>mechanistic</strong> approach not a <strong>humanistic</strong> one. Documents should be written for people, not machines. Our tools for documentation should reflect this as well.</p></div></div></section><section class="chapter" id="tooling-for-documents"><h2 class="chapter">3  &nbsp;&nbsp; Tooling for Documents</h2><section class="section" id="documentation-bugs"><h3 class="section">3.1  &nbsp;&nbsp; Documentation Bugs</h3><div class="paragraph"><p>Programming is a very precise art form. Programming mistakes, especially the little ones, can result in dire consequences and much wasted time. We therefore use tools such as debuggers, type checkers and test frameworks to make our coding lives easier and our source code correct.</p><p>Documentation is the programmers' means of communicating how to use or build upon a library, usually to a larger audience of peers. This means that any mistakes in the documentation results in wasted time for <em>all involved</em>. Therefore any mistake in documentation can have a <em>greater effect</em> than a mistake in source code because it wastes <em>everybody's</em> time.</p><p>There are various tools for documentation like <code>latex</code>, <code>wiki</code> and <code>markdown</code>. However, none address the issue that code examples in the documentation are not checked for correctness. A fictitious example illustrates how errors in documentation can produced and propagated can be seen in <a href='#a-bugs-life'>chapter </a></p></div></section><section class="section" id="test-cases-vs-docstrings"><h3 class="section">3.2  &nbsp;&nbsp; Test Cases vs Docstrings</h3><div class="paragraph"><p>The best description for our functions are not found in <em>source files</em> but in the <em>test files</em>. Test files <em>are</em> potentially the best documentation because they provide information about what a function outputs, what inputs it accepts and what exceptions it throws. Instead of writing vague phrases (<a href='#split-source'>e.</a>) in the doc-string, we can write the descriptions of what a function does directly with our tests (<a href='#split-tests'>e.</a>).</p></div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(defn split-string
  &quot;The split-string function is used to split a string
  in two according to the idx that is passed.&quot;
  [s idx]
  [(.substring s 0 idx) (.substring s idx)])</div><div class="code" hljs="hljs" language="clojure" no-escape="no-escape">(facts &quot;split-string usage:&quot;

  (split-string &quot;abcde&quot; 1)
  =&gt; [&quot;a&quot; &quot;bcde&quot;]

  (split-string &quot;abcde&quot; 3)
  =&gt; [&quot;abc&quot; &quot;de&quot;])</div><div class="paragraph"><p>It can be seen that test cases provides a much better explaination for <code>split-string</code> than the source doc-string. The irony however is that when a readme says: <em><code>'for documentation, please read the test files'</code></em>, the common consensus is that the project developer is too slack to write proper documentation. However, if we are truly honest with our own faults, this occurs because most programmers are too slack to read tests. <strong>We only want to read pretty documentation.</strong></p></div></section><section class="section" id="bridging-the-divide"><h3 class="section">3.3  &nbsp;&nbsp; Bridging the Divide</h3><div class="paragraph"><p><code>lein-midje-doc</code> plugin attempts to bridge the gap between writing tests and writing documentation by introducing three novel features:</p></div><section class="subsection" id="features"><h4 class="subsection">3.3.1  &nbsp;&nbsp; Features</h4><div class="paragraph"><p>The features are:<ol><li>To generate <code>.html</code> documentation from a <code>.clj</code> test file.<ol><li>To express documentation elements as clojure datastructures.</li><li>To render clojure code and midje facts as code examples.</li><li>To allow tagging of elements for numbering and linking.  </li></ol></li></ol></p></div></section><section class="subsection" id="benefits"><h4 class="subsection">3.3.2  &nbsp;&nbsp; Benefits</h4><div class="paragraph"><p>In this way, the programmer as well as all users of the library benefits:</p><ol><li>All documentation errors can be eliminated.<ol><li>Removes the need to cut and copy test examples into a readme file.</li><li>Entire test suites can potentially be turned into nice looking documentation with relatively little work. </li></ol></li></ol></div></section></section></section><section class="chapter" id="end-notes"><h2 class="chapter">4  &nbsp;&nbsp; End Notes</h2><div class="group"><div class="paragraph"><p>For any feedback, requests and comments, please feel free to lodge an issue on github or contact me directly.</p><p>Chris.</p></div></div></section>
    </div>
</div><!--end of .container-->

</body>

<script>
  $('#nav').affix({
    offset: {
        top: $('#nav').offset().top,
        bottom: $('footer').outerHeight(true) + $('.application').outerHeight(true) + 40
    }});
</script>


<script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
</body>
</html>
